var Base={init:function(){},enable:function(){return this.init(),this}},Helper={isNullable:function(a){return void 0===a||null===a}},BaseOverlay=$.extend({},Base,{color:"#000",opacity:"0.5",zIndex:"99999",getElement:function(){var a=this;return Helper.isNullable(this.element)&&(this.element=$('<div class="overlay"></div>').css({backgroundColor:a.color,opacity:a.opacity,zIndex:a.zIndex})),this.element},show:function(){this.getElement().appendTo($("body")).show()},hide:function(){this.getElement().remove()},init:function(){}}),FadeOverlay=$.extend({},BaseOverlay,{duration:function(){return 100},clickHandler:function(){},show:function(){var a=this;this.getElement().appendTo($("body")).fadeIn(this.duration()).off("click").click(function(c){a.clickHandler(c)})},hide:function(){this.getElement().fadeOut(this.duration(),function(){$(this).remove()})}}),BasePopup=$.extend({},Base,{classNames:["popup"],contentClassName:"content",closeClassName:"close",zIndex:"199999",canESC:!0,getElement:function(){var a=this;return Helper.isNullable(this.element)&&(this.element=$("<div />").addClass(this.classNames.join(" ")).css({zIndex:a.zIndex}).append($("<div />").addClass(this.contentClassName)).append($('<a href="javascript:;" title="关闭"></a>').addClass(this.closeClassName)),this.canESC&&$(document).keydown(function(c){27===c.keyCode&&a.hide()})),this.element},getContentElement:function(){return this.getElement().find("."+this.contentClassName)},getCloseElement:function(){return this.getElement().find("."+this.closeClassName)},add:function(){var a=this;this.getElement().appendTo($("body")),this.updatePosition(),this.getCloseElement().off("click").click(function(){return a.hide(),!1})},show:function(){this.add(),this.getElement().show()},remove:function(){this.getElement().remove()},hide:function(){this.remove()},isVisible:function(){return this.getElement().is(":visible")},updatePosition:function(){var a=($(window).height()-this.getElement().height())/3;0>a&&(a=25),this.getElement().css({left:($(window).width()-this.getElement().width())/2,top:$(document).scrollTop()+a})},setContent:function(a){this.getContentElement().html(a),this.isVisible()&&this.updatePosition()},clearContent:function(){this.setContent("")},setLoadingContent:function(a){this.setContent($('<div class="loading" />').append($('<div class="txt" />').html(a)).append($('<div class="img" />')))},createButton:function(a){return $('<button class="button" />').html($("<span />").html(a))},createCancelLink:function(a){var c=this;return Helper.isNullable(a)&&(a="取消"),$('<a href="#"></a>').html(a).off("click").click(function(){return c.hide(),!1})},init:function(){}}),OverlayPopup=$.extend({},Base,BasePopup,{getOverlay:function(){var a=this;return Helper.isNullable(this.overlay)&&(this.overlay=$.extend({},FadeOverlay,{clickHandler:function(){a.hide()}},a.overlayOptions())),this.overlay},overlayOptions:function(){return{}},duration:function(){return this.getOverlay().duration()},show:function(){this.beforeShow(),this.getOverlay().show(),this.add(),this.getElement().fadeIn(this.duration()),this.afterShow()},hide:function(){var a=this;this.beforeHide(),this.getOverlay().hide(),this.getElement().fadeOut(this.duration(),function(){a.remove()}),this.afterHide()},beforeShow:function(){},afterShow:function(){},beforeHide:function(){},afterHide:function(){}}),DarkOverlayPopup=$.extend({},OverlayPopup,{overlayOptions:function(){return $.extend({},{clickHandler:function(){},opacity:"0.4"},this.darkOverlayOptions)},darkOverlayOptions:{}});!function(a){"use strict";var c=[],h=function(v,g){var y=this,$=this.$element=a(v),_=this.option=a.extend({},h.DEFAULT,g);"click"===_.trigger?a("[data-dropdown-role=trigger]",$).on("click.component.dropdown",a.proxy(this.toggle,this)):"hover"===_.trigger&&$.hover(function(){y.openMenu()},function(){y.closeMenu()}),_.autoClose&&$.on("click.component.dropdown",a.proxy(this.toggle,this)),$.on("click.component.dropdown",function(e){e.stopPropagation()}),c.push(this)};h.DEFAULT={trigger:"click",autoClose:!0},h.prototype.toggle=function(e){var a=this.$element;a.hasClass("open")?this.closeMenu():(v(),this.openMenu()),e.stopPropagation()},h.prototype.openMenu=function(){var a=this.$element;return a.hasClass("disabled")||a.data("disabled")===!0?!1:void a.addClass("open")},h.prototype.closeMenu=function(){this.$element.removeClass("open")};a.fn.newDropdown;a.fn.newDropdown=function(c){return this.each(function(){var v=a(this),g=v.data("component.dropdown"),y=a.extend({},c,v.data());g||v.data("component.dropdown",g=new h(this,y))})};var v=function(){a.each(c,function(i,a){a.$element.hasClass("open")&&a.$element.removeClass("open")})};a(document).on("click.component.dropdown",function(){v()}),a(function(){a("[data-component=dropdown]").newDropdown()})}(window.jQuery),function(a){"use strict";var c=function(h,v){var g=this,y=this.$element=a(h);y.newDropdown({autoClose:!1}),this.dropdown=y.data("component.dropdown"),this.$indicator=a(".dropdown__indicator",y),this.$inputContainer=a('<div class="dropdown__input-container hidden" />').appendTo(y),this.options=a.extend({},c.DEFAULT,this._constructor.DEFAULT,v),this.name=y.data("name")||"",this.value=function(){var c=y.data("value");return c instanceof Array?c:c instanceof Object?a.map(c,function(a,c){return c}):void 0!==c&&""!==c?[c]:[]}(),h.type="ImitateSelect",this._bind(),setTimeout(function(){g._init()},0)};c.DEFAULT={multiple:!1,valuelimit:-1,placeholder:"",multipleIndicatorTemplate:['<span class="dropdown__indicator__option">','<span class="label"></span>','<span class="close">×</span>',"</span>"].join("")},c.prototype._init=function(){this._refresh()},c.prototype._bind=function(){var a=this;this.$element.on("close",function(){a.dropdown.closeMenu()}),this.$element.on("change",function(){a._refresh()})},c.prototype.getNameByValue=function(){},c.prototype.getLabel=function(){var c=this,h=this.get();return"string"==typeof h?this.getNameByValue(h):a.isArray(h)?a.map(h,function(a){return c.getNameByValue(a)}):void 0},c.prototype.set=function(a){return this.options.multiple&&this.options.valuelimit>0&&this.value.length>=this.options.valuelimit?(this.$element.trigger("error","maxiam value"),void this.$element.trigger("close")):(a=a instanceof Array?a:a+"",void(this.has(a)?this.$element.trigger("close"):(this.options.multiple?this.value.push(a):(this.value[0]=a,this.$element.trigger("close")),this.afterSet&&this.afterSet(),this.$element.trigger("change"))))},c.prototype.get=function(){return this.options.multiple?this.value:this.value[0]},c.prototype.has=function(c){return!!~a.inArray(c,this.value)},c.prototype._remove=function(c,h){var v=a.proxy(function(c){var h=a.inArray(c,this.value);-1!==h&&this.value.splice(h,1)},this);c instanceof Array?a.each(c,function(i,a){v(a)}):v(c),h||this.$element.trigger("change")},c.prototype.removeAll=function(){this.value=[],this.$element.trigger("change")},c.prototype._buildMultipleIndicator=function(c,h){var v=this,g=a(this.options.multipleIndicatorTemplate).click(function(){return!1});return g.find(".label").text(c),g.find(".close").click(function(){return v._remove(h),a(this).parents(".dropdown__indicator__option").remove(),!1}),g},c.prototype._refreshIndicator=function(){this.$indicator.empty().removeClass("placeholder"),a.each(this.value,a.proxy(function(i,a){var c=this.getNameByValue(a);c!==!1&&(this.options.multiple?this.$indicator.append(this._buildMultipleIndicator(c,a)):this.$indicator.text(c))},this)),0===this.value.length&&this.$indicator.text(this.options.placeholder).addClass("placeholder")},c.prototype._refreshInput=function(){""!==this.name&&(this.$inputContainer.empty(),"string"==typeof this.name?a.each(this.value,a.proxy(function(c,h){this.$inputContainer.append(a('<input type="hidden" name="'+this.name+'" value="'+h+'" />'))},this)):this.name instanceof Array&&a.each(this.value,a.proxy(function(c,h){var v=this.name[c];v&&this.$inputContainer.append(a('<input type="hidden" name="'+v+'" value="'+h.value+'" />'))},this)))},c.prototype._refreshOption=function(){},c.prototype._refresh=function(){this._refreshIndicator(),this._refreshInput(),this._refreshOption()},c.prototype.bugFixRefresh=function(a){this.getNameByValue(a)===!1?(this.value=[],this._refresh()):(this.value=[a],this._refresh())};var h=function(){var h=this;c.apply(this,arguments),this.cachedOptions=function(){var c={};return a(".option",h.$element).each(function(){var h=a(this);c[h.data("value")]=h.data("label")||h.text()}),c}(),this.bindOption()};h.DEFAULT={},h.prototype=a.extend({},c.prototype,{_constructor:h,bindOption:function(){var c=this,h=(this.$element,this.$options=a(".option",this.$element));h.click(function(){c.set(a(this).data("value"))})},getNameByValue:function(a){return this.cachedOptions[a]||!1},_refreshOption:function(){this.$options.removeClass("active"),a.each(this.value,a.proxy(function(i,a){this.$options.filter('[data-value="'+a+'"]').addClass("active")},this))}});var v=function(){c.apply(this,arguments),this.value=function(a){return 0===a.value.length?a.value:[a.value]}(this),this.currentLevel=0,this.$container=a('<div class="ajax-select" />').appendTo(a(".dropdown__list",this.$element)),this.levels=[],this.cachedOptions={},this.options.nolimit=function(a){for(var c=a.options.nolimit,h=[],i=0;i<a.options.maxlevel;i++)h[i]="boolean"==typeof c?c:c[i];return h}(this),this.rvalue=this.$element.data("rvalue")?JSON.parse(JSON.stringify(this.$element.data("rvalue"))):[],this.render(1)};v.DEFAULT={label:"请选择",nolimit:!1,activeClass:"active",template:['<div class="ajax-select__container">','<div class="ajax-select__top">','<span class="ajax-select__label"></span>','<span class="ajax-select__prevstep">上一步</span>','<div class="ajax-select__search">','<input type="text" />','<span class="search-btn">搜索</span>',"</div>","</div>",'<div class="ajax-select__main"></div>',"<div>"].join("")},v.options={},v.AjaxCache={},v.prototype=a.extend({},c.prototype,{_constructor:v,render:function(c){var h=this,g=(this.currentLevel,function(){var a=h.options.level[c-1].api;return"function"==typeof a?a(h.levels):a}()),y=function(a){return void 0===v.AjaxCache[g]&&(v.AjaxCache[g]=JSON.parse(JSON.stringify(a))),a.forEach(function(a){v.options[a.value]=a.name}),h.$container.removeClass("loading"),0===a.length?void h.set(h._getResult()):(h.currentLevel=c,h.currentOptions=a,h.$container.empty().append(h.buildTemplate(h._processAjaxData(a))),void h._refreshOption())};"string"==typeof g&&(this.$container.addClass("loading"),v.AjaxCache[g]?y(JSON.parse(JSON.stringify(v.AjaxCache[g]))):a.get(SELECT_ORIGIN+g).done(y))},_processAjaxData:function(c){return a.each(c,a.proxy(function(i,c){var h=this;this.cachedOptions[c.value]=function(){return h.options.multiple?c.name:h.options.joinname?a.map(h.levels.slice(1,h.currentLevel),function(a){return a&&a.name?a.name:void 0}).concat([c.name]).join(h.options.joinname):c.name}()},this)),c.sort(function(a,c){return a.name.localeCompare(c.name)}),this.options.nolimit[this.currentLevel-1]!==!0&&c.unshift({name:"不限",value:null}),c},_isSelected:function(c){return!!~a.inArray(this._getRealValue(c),this.value)},buildTemplate:function(c){var h=this,v=a(this.options.template),g=this.currentLevel,y=this.options.level[g-1],$=a(".ajax-select__label",v),_=a(".ajax-select__prevstep",v),b=a(".ajax-select__search",v);return $.text(1===g?this.options.label:this.levels[g-1].name),1!==g?_.click(function(){h.render(g-1)}):_.hide(),y.search&&(b.show(),this.bindSearch(b,c,a(".ajax-select__main",v))),a(".ajax-select__main",v).append(this.buildOption(c)),v},buildOption:function(c){{var h=this;this.currentLevel}return a.map(c,function(c){return a('<span class="ajax-select__option option" />').text(c.name).attr("data-value",c.value+"").click(function(){h.levels[h.currentLevel]=c,h.rvalue[h.currentLevel-1]=c,h.currentLevel<h.options.maxlevel&&null!==c.value?h.render(h.currentLevel+1):null===c.value?h._processUnlimit():h.has(c.value)?h._remove(c.value):(h._remove(h._getRealValue(null),!0),h.set(h._getResult()))})})},_getRealValue:function(a){return null===a&&this.levels[this.currentLevel-1]&&void 0!==this.levels[this.currentLevel-1].value?this.levels[this.currentLevel-1].value:a},_processUnlimit:function(){var c=this._getRealValue(null);return this.has(c)?void this._remove(c):void(null!==c?(this._remove(a.map(this.currentOptions,function(a){return a.value})),this.set(this._getResult())):this.removeAll())},bindSearch:function(c,h,v){var g=this,y=function(){var c=[],v=function(c){var v=new RegExp(c);return a.map(h,function(a){return v.test(a.name)?a:void 0})};return function(a){return""===a?h:c[a]?c[a]:(c[a]=v(a),c[a])}}();"oninput"in c[0]?c.find("input").on("input",function(){var c=a(this).val();v.empty().append(g.buildOption(y(c)))}).on("change",function(e){e.stopPropagation()}):c.find("input").on("propertychange",function(e){if("value"===e.originalEvent.propertyName){var c=a(this).val();v.empty().append(g.buildOption(y(c)))}}).on("change",function(e){e.stopPropagation()})},getNameByValue:function(a){return v.options[a]||!1},_refreshOption:function(){a(".option.active",this.$element).removeClass("active"),a.each(this.value,a.proxy(function(i,c){var h=c[this.currentLevel-1];null===h&&(h="null"),a(".option",this.$element).filter("[data-value="+h+"]").addClass("active")},this))},_getResult:function(){return this.levels.slice(1).map(function(a){return a.value})},_refreshInput:function(){this.$inputContainer.empty(),this.name instanceof Array&&this.value[0]&&a.each(this.value[0],a.proxy(function(c,h){var v=this.name[c];h=h||"",v&&this.$inputContainer.append(a('<input type="hidden" name="'+v+'" value="'+h+'" />'))},this))},_refreshIndicator:function(){var c=this;if(this.$indicator.empty().removeClass("placeholder"),0===this.value.length||0===this.value[0].length)this.$indicator.text(this.options.placeholder).addClass("placeholder");else{for(var h=this.value[0].slice(0).reverse().map(function(a){return a?c.getNameByValue(a):"passed"}),i=0,g=h.length;g>i;i++){var y=h[i];if(!y){var $=c.value[0][g-1-i],_=c.options.fullfill[g-1-i];return void(_&&_($)&&a.get(SELECT_ORIGIN+_($)).then(function(a){Object.keys(a).forEach(function(c){v.options[a[c].value]=a[c].name}),c._refreshIndicator()}))}}this.$indicator.text(c.options.setLabel(h.reverse().map(function(a){return"passed"===a?"":a})))}},afterSet:function(){this.rvalue.splice(this.currentLevel),this.$element.data("rvalue",this.rvalue)}});var g=function(){var h=this;c.apply(this,arguments),this.options.colorMap=JSON.parse(JSON.stringify(h.options.colorMap)),this.$container=a('<div class="palette-select" />').appendTo(a(".dropdown__list",this.$element)),this.color2Element={},this._buildPalette()};g.DEFAULT={colorMap:[[[0,68,102,153,204,238,243,255]],[[[255,0,0],[255,153,0],[255,255,0],[0,255,0],[0,255,255],[0,0,255],[153,0,255],[255,0,255]]],[[[244,204,204],[252,229,205],[255,242,204],[217,234,211],[208,224,227],[207,226,243],[217,210,233],[234,209,220]],[[234,153,153],[249,203,156],[255,229,153],[182,215,168],[162,196,201],[159,197,232],[180,167,214],[213,166,189]],[[224,102,102],[246,178,107],[255,217,102],[147,196,125],[118,165,175],[111,168,220],[142,124,195],[194,123,160]],[[204,0,0],[230,145,56],[241,194,50],[106,168,79],[69,129,142],[61,133,198],[103,78,167],[166,77,121]],[[153,0,0],[180,95,6],[191,144,0],[56,118,29],[19,79,92],[11,83,148],[53,28,117],[116,27,71]],[[102,0,0],[120,63,4],[127,96,0],[39,78,19],[12,52,61],[7,55,99],[32,18,77],[76,17,48]]]]},g.prototype=a.extend({},c.prototype,{_constructor:g,_buildPalette:function(){var c=this;this.options.transparent&&c.options.colorMap.unshift([["transparent"]]),this.$container.append(a.map(c.options.colorMap,function(h){return a("<table/>").append(a.map(h,function(h){return a("<tr/>").append(a.map(h,function(h){var v=c._buildColorStr(h),g=a("<div/>").attr("title","transparent"===h?"透明":v).css("background-color",v).addClass("transparent"===h?"transparent-color":"").click(function(){c.set(v)}).appendTo(a("<td/>")).parent();return c.color2Element[v]=g,g}))}))}))},_buildColorStr:function(c){var h;return"number"==typeof c?h="rgb("+[c,c,c].join()+")":a.isArray(c)&&3===c.length?h="rgb("+c.join()+")":"transparent"===c&&(h="transparent"),null===Helper.getColorValueOfCss(h)?"transparent":"#"+Helper.getColorValueOfCss(h)},getNameByValue:function(a){var c=null===Helper.getColorValueOfCss(a)?"transparent":"#"+Helper.getColorValueOfCss(a);return void 0===this.color2Element[c]?!1:a},_refreshOption:function(){a(".selected",this.$element).removeClass("selected"),a(".dropdown__indicator",this.$element).css("background",""),a.each(this.value,a.proxy(function(i,c){c=null===Helper.getColorValueOfCss(c)?"transparent":"#"+Helper.getColorValueOfCss(c),a(".dropdown__indicator",this.$element).css("background",c),this.color2Element[c]&&this.color2Element[c].addClass("selected")},this))}});var y={select:{type:h,option:{}},"select-palette":{type:g,option:{}},"select-city":{type:v,option:{joinname:"-",maxlevel:2,level:[{api:"/api/province.json"},{api:function(a){return"/api/province/cities/"+a[1].value+".json"}}]}},"select-university":{type:v,option:{maxlevel:2,level:[{api:"/api/province.json"},{api:function(a){return"/api/province/universities/"+a[1].value+".json"},search:!0},{api:function(a){return"/api/province/university/colleges/"+a[2].value+".json"}}],fullfill:[null,function(a){return"/api/"+a+"/province.json"},function(a){return"/api/"+a+"/university.json"}],setLabel:function(a){return a.slice(1).filter(function(a){return a}).join("-")}}}};a.fn.imitateSelect=function(c,h){return this.each(function(){var c=a(this),v=v||c.data("component");if(void 0!==y[v]){var g=y[v],$=function(){var h=c.data(),v={};return a.each(h,function(a,c){var h;/^option/.test(a)&&(h=a.replace(/^option/,""),h=h.charAt(0).toLowerCase()+h.slice(1),v[h]=c)}),v}(),_=a.extend({},g.option,$,h),b=c.data("component.select");b||c.data("component.select",b=new g.type(this,_))}})},a.valHooks.ImitateSelect={get:function(c){return a(c).data("component.select").get()},set:function(c,h){a(c).data("component.select").set(h)}},a(function(){a("[data-component|=select]").imitateSelect()})}(window.jQuery),function(){var a=function(a){this.$trigger=a.$trigger,this.selectorType=a.selectorType,this.addAny=a.addAny,this.drill=a.drill,this.addAnyAtLevel=a.addAnyAtLevel,this.deviceType=this.getDeviceType(),this.feedbackFrom=a.feedbackFrom,this.API={internalProvince:"http://cv.qiaobutang.com/api/province.json",foreignArea:"http://www.qiaobutang.com/university_choice/foreign.json",internalUniv:"http://cv.qiaobutang.com/api/province/universities/",foreignUniv:"http://www.qiaobutang.com/university_choice/foreign/college.json",internalCollege:"http://cv.qiaobutang.com/api/province/university/colleges/",internalCity:"http://cv.qiaobutang.com/api/province/cities/"},this.apiInstruction=[],this.$container=null,this.selected=[],this.bindEvent()};a.prototype.getDeviceType=function(){var a=navigator.userAgent.toLowerCase();return-1!==a.search(/iphone|ipad|itouch/g)?"ios":-1!==a.search(/android/)?"android":-1!==a.search(/windows phone/)?"windows phone":void 0},a.prototype.getDiv=function(a){return $('<div class="'+a+'"></div>')},a.prototype.createUI=function(){var a=this;this.$container=this.getDiv("univ"===this.selectorType?"selector-wrapper":"selector-wrapper selector-wrapper_area"),this.$tab=null,this.$head=this.getDiv("selector__head"),this.$body=this.getDiv("selector__body"),this.$list=this.getDiv("selector__list"),this.$closeIcon=$('<a href="javascript:;" class="selector__close"></a>'),this.$tip=this.getDiv("selector__tip"),this.$search=$('<input type="text" class="selector__search" placeholder="快速检索"/>').hide(),this.$instruct=this.getDiv("selector__instruct"),this.$back=$('<a href="javascript:;" class="selector__back"></a>'),this.$instructText=$("<span>选择省/市</span>"),this.$loading=$('<div class="selector__loading"></div>').hide(),this.$instruct.append(this.$back).append(this.$instructText),"univ"===this.selectorType&&(this.$tab=this.getDiv("selector__tab"),this.$tab.append($('<a class="tab__item selected" href="javascript:;" data-type="internal">国内</a>')).append($('<a class="tab__item" href="javascript:;" data-type="foreign">国外</a>')).on("click",function(e){a.apiInstruction.pop(),"internal"===e.target.getAttribute("data-type")?(a.getData("internalProvince"),a.currentDataType="internalProvince",a.apiInstruction.push("internalProvince")):(a.getData("foreignArea"),a.currentDataType="foreignArea",a.apiInstruction.push("foreignArea")),$(e.target).addClass("selected").siblings("a").removeClass("selected")})),this.deviceType||this.$instruct.hide(),this.$container.append(this.$head.append(this.$tab).append(this.$instruct).append(this.$search).append(this.$closeIcon)).append(this.$body.append(this.$list)).append(this.$tip.append($('<a target="_blank" href="http://cv.qiaobutang.com/help/feedback?'+this.feedbackFrom+'">没有您的院校?</a>'))).append(this.$loading),this.$closeIcon.on("click",function(){a.hiddenUI()}),this.$search.on("input",function(){a.quickSearch($(this).val())}),this.$search.on("click",function(){}),this.$back.on("click",function(e){e.stopPropagation(),a.getBack()}),this.setUICss(),$(".selector-wrapper").remove(),$("body").append(a.$container),this.$container.on("click",function(e){e.stopPropagation()}),$(document).on("click",function(){a.$container&&a.hiddenUI()})},a.prototype.setUICss=function(){this.$container.addClass(this.deviceType?"mobile":"desktop")},a.prototype.hiddenUI=function(){this.$container.remove(),this.$container=null,this.selected=[],this.apiInstruction=[],$(document).off("click")},a.prototype.getBack=function(){if(this.currentLevel--,this.apiInstruction.pop(),this.currentDataType=this.apiInstruction[this.apiInstruction.length-1],0===this.currentLevel)this.hiddenUI();else if(1===this.currentLevel)this.getData(this.currentDataType),this.selected=[];else{this.selected.pop();var a=this.selected.pop();this.drillNextLevelData(a.value,a.name)}},a.prototype.quickSearch=function(a){this.$list.children(".selector__option").each(function(){-1===$(this).text().indexOf(a)?$(this).hide():$(this).show()})},a.prototype.bindEvent=function(){var a=this;this.$trigger.mousedown(function(){$(this).data("mousedown",!0)}),this.$trigger.click(function(e){e.stopPropagation(),a.render(),$(this).data("mousedown",!1)}),this.$trigger.focus(function(){$(this).data("mousedown")||a.render()})},a.prototype.apiCallback=function(a){a.length>0?this.fillOption(a):this.setValue()},a.prototype.fillOption=function(a){var c=this,h=a.map(function(a){var h=a.value||a.countryId||a.universityId;return $('<a class="selector__option" href="javascript:;" data-value="'+h+'">'+a.name+"</a>").on("click",function(e){$(e.target).off("click"),c.drillNextLevelData(e.target.getAttribute("data-value"),e.target.innerHTML)})});this.currentLevel>1?(this.$tab&&this.$tab.hide(),this.$instruct.show(),this.$search.show(),this.$search.val(""),this.$instructText.text(this.specialSelected(0).name.join("/"))):(this.$tab&&this.$tab.show(),this.$search.hide(),this.deviceType||(this.$instruct.hide(),this.$instructText.text("选择省/市"))),this.$list.empty().append(h)},a.prototype.drillNextLevelData=function(a,c){if(this.selected.push({name:c,value:"any"===a?"":a}),"不限"===c||1===this.drill&&1===this.currentLevel||"全国"===c)return void this.setValue();switch(this.currentDataType){case"internalProvince":"univ"===this.selectorType?(this.getData("internalUniv",a),this.currentDataType="internalUniv",this.apiInstruction.push("internalUniv"),this.currentLevel=2):(this.getData("internalCity",a),this.currentDataType="internalCity",this.apiInstruction.push("internalCity"),this.currentLevel=2);break;case"foreignArea":this.getData("foreignUniv",a),this.currentDataType="foreignUniv",this.apiInstruction.push("foreignUniv"),this.currentLevel=2;break;case"internalUniv":this.currentDataType="internalCollege",this.currentLevel=3,this.getData("internalCollege",a);break;default:this.setValue()}},a.prototype.tryAgain=function(a,c){var h=$('<a class="selector__tryAgain" href="javascript:;">出错咯，请重试</a>'),v=this;this.$loading.hide(),this.$container.append(h),h.click(function(){v.getData(a,c),h.remove()})},a.prototype.getData=function(a,c){var h=this,v=h.API[a]+(c?c+".json":"");h.$loading.show(),$.ajax("foreignUniv"===a?{type:"GET",url:h.API[a],data:{countryId:c},success:function(a){h.$loading.hide(),h.apiCallback(a.info)},error:function(){h.tryAgain(a,c)}}:{type:"GET",url:v,success:function(c){h.$loading.hide(),$.isArray(c)?(h.addAny&&"internalProvince"===a?c.unshift({name:"全国",value:"_CHS"}):(h.addAny||h.currentLevel===h.addAnyAtLevel)&&c.unshift({name:"不限",value:"any"}),h.apiCallback(c)):h.apiCallback(c.info)},error:function(){h.tryAgain(a,c)}})},a.prototype.specialSelected=function(a){for(var c={name:[],value:[]},i=a,h=this.selected.length;h>i;i++)c.name.push(this.selected[i].name),c.value.push(this.selected[i].value);return c},a.prototype.setValue=function(){var a;if("area"===this.selectorType){a=this.specialSelected(0).name;var c=this.selected.length;c>1&&"不限"===this.selected[c-1].name&&this.selected.pop()}else a=this.specialSelected(1).name;this.$trigger.val(a.join(" - ")).attr("data-value",JSON.stringify(this.selected)),this.$trigger.trigger("change"),this.selected=[],this.hiddenUI()},a.prototype.render=function(){this.$container?this.hiddenUI():(this.createUI(),this.getData("internalProvince"),this.currentLevel=1,this.currentDataType="internalProvince",this.apiInstruction.push("internalProvince"))},$.fn.universitySelector=function(c){new a({$trigger:$(this),selectorType:"univ",addAny:c?c.addAny:!1,drill:c?c.drill:"",addAnyAtLevel:c?c.addAnyAtLevel:"",feedbackFrom:c?c.feedbackFrom:""})},$.fn.areaSelector=function(c){new a({$trigger:$(this),selectorType:"area",addAny:c?c.addAny:!1,drill:c?c.drill:""})}}(window.jQuery);